import requests
from bot.external import reverse_hash_fail, SLACK_HOOK

def test_reverse_hash_fail(mocker):
    mocker.patch('requests.post')
    #pylint: disable=C0301
    hex_message = '000000000000000000000000A1796Db2b57144a2C21A92AE647B86B9641A47ac00000000000000000000000000000000000000000000000000000000000001c8000000000000000000000000000000000000000000000000000000000000000200000000000000000000000035a2119712091a77B40FaB61ecabc8fBE950eb1600000000000000000000000055de2e479F3D0183D95f5A969bEEB3a147F6004900000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000b1a2bc2ec5000000000000000000000000000000000000000000000000000000b1a2bc2ec50000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000038d7ea4c680002f29e990b57b3c5621748e5dfb3cf7c098f0a3db21c5aa444bb8685f7042a29c'
    reverse_hash_fail(hex_message)

    slack_alert = 'Stumped by player 35a2119712091a77b40fab61ecabc8fbe950eb16. Cannot decrypt move hash 2f29e990b57b3c5621748e5dfb3cf7c098f0a3db21c5aa444bb8685f7042a29c'
    requests.post.assert_called_once_with(SLACK_HOOK, json={'text': slack_alert}) #pylint: disable=E1101
